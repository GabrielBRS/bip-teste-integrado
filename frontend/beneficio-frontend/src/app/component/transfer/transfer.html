<mat-card class="transfer-card">
  <div class="header">
    <div>
      <h1>Transferência de Benefícios</h1>
      <p>Selecione a origem, o destino e o valor da transferência.</p>
    </div>
  </div>

  <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
    <div class="form-grid">

      <mat-form-field appearance="outline">
        <mat-label>Benefício de origem</mat-label>
        <mat-icon matPrefix>account_balance_wallet</mat-icon>
        <mat-select formControlName="fromId" required>
          <mat-option *ngFor="let b of beneficios" [value]="b.id">
            {{ b.nome }} ({{ b.valor | currency: 'BRL' }})
          </mat-option>
        </mat-select>
        <mat-error *ngIf="form.controls.fromId.hasError('required')">
          Informe o benefício de origem
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Benefício de destino</mat-label>
        <mat-icon matPrefix>card_giftcard</mat-icon>
        <mat-select formControlName="toId" required>
          <mat-option *ngFor="let b of beneficios" [value]="b.id">
            {{ b.nome }} ({{ b.valor | currency: 'BRL' }})
          </mat-option>
        </mat-select>
        <mat-error *ngIf="form.controls.toId.hasError('required')">
          Informe o benefício de destino
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Valor da transferência</mat-label>
        <mat-icon matPrefix>monetization_on</mat-icon>
        <input matInput type="number" min="0.01" step="0.01" formControlName="amount" required />
        <span matTextSuffix>BRL</span>
        <mat-error *ngIf="form.controls.amount.hasError('required')">
          Informe o valor da transferência
        </mat-error>
        <mat-error *ngIf="form.controls.amount.hasError('min')">
          O valor deve ser maior que zero
        </mat-error>
      </mat-form-field>

      <div class="form-error-container" *ngIf="form.hasError('sameAccount') && form.touched">
        <mat-icon>error_outline</mat-icon>
        <span>O benefício de origem deve ser diferente do benefício de destino.</span>
      </div>
    </div>

    <div class="actions">
      <button mat-stroked-button type="button" routerLink="/beneficios" [disabled]="saving">
        Cancelar
      </button>
      <button mat-flat-button color="primary" type="submit" [disabled]="saving || form.invalid">
        <mat-spinner *ngIf="saving" diameter="20" class="button-spinner"></mat-spinner>
        <mat-icon *ngIf="!saving">sync_alt</mat-icon>
        {{ saving ? 'Transferindo...' : 'Transferir' }}
      </button>
    </div>
  </form>
</mat-card>
